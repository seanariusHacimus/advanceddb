/*! For license information please see 978.5ea8559f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkadvanced_db=self.webpackChunkadvanced_db||[]).push([[978],{11978:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var r=t(9950),a=t(27741),l=t(77645),i=t(48538),n=t(98412),o=t(73878),c=t(93047),d=t(79016),u=t(56033),m=t(89017),h=t(32741),p=t(54998),x=t(22253),g=(t(61456),t(14535));const _=(0,t(36230).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var j=t(52607),b=t(44414);const v={role:"",member_groups:[],leader_groups:[],img:""};const y={title:{fontSize:24,fontWeight:400,lineHeight:"30px",color:"#252A32"}},k=function(e){const s=(0,o.d4)(e=>e.auth.account||{}),{selectedUser:t,accounts:k,rocketAuth:f,allMembersById:w,allAccountsById:A,setSelectedUser:C}=(0,r.useContext)(p.d),[N,S]=(0,r.useState)([]),[I,z]=(0,r.useState)([]),[M,U]=(0,r.useState)(""),[X,B]=(0,r.useState)(!1),[E,L]=(0,r.useState)(e.selectedMembers.map(e=>e._id)||[]),[P,H]=(0,r.useState)({}),[K,O]=(0,r.useState)(""),[T]=(0,x.Y)(),$=(0,r.useCallback)(e=>{const s=N.filter(e=>e.name.toLowerCase().includes(M.toLowerCase()));B(!0),z(s)},[M,N]),G=(0,r.useCallback)(async()=>{const{token:e,user_id:s}=f,t=await h.f.get("/users.list",{headers:{"X-Auth-Token":"".concat(e),"X-User-Id":s}});t.data.success&&S(t.data.users)},[S,f]),W=(0,r.useCallback)(async s=>{try{const{token:r,user_id:a}=f;(await h.f.post("/groups.invite",{roomId:t.rid,userId:s},{headers:{"X-Auth-Token":"".concat(r),"X-User-Id":a}})).data.success&&(L(e=>[...e,s]),e.fetchGroupMembers())}catch(r){console.log(r.response)}},[f,t]);(0,r.useEffect)(()=>{G()},[]);const Y=X?I:N;return(0,b.jsx)(a.A,{title:null,footer:null,zIndex:1080,onOk:s=>{O(""),S([]),e.handleModal()},destroyOnClose:!0,onCancel:s=>{O(""),S([]),e.handleModal()},visible:e.visible,children:(0,b.jsxs)(d.x5,{children:[(0,b.jsx)("h2",{style:y.title,children:T("Add new members")}),(0,b.jsxs)(u.so,{jc:"space-between",style:{padding:"0 0 20px 0",borderBottom:"1px solid #e7e7e7"},children:[(0,b.jsxs)("div",{id:"inner-search-wrapper",style:{width:"100%"},children:[(0,b.jsx)(l.A,{type:"search",value:M,id:"search-title",autoComplete:"off",style:{width:"100%"},placeholder:T("Search member"),onChange:e=>U(e.target.value),onKeyPress:e=>{if(13===e.which)return $(e)}}),M&&(0,b.jsx)("span",{onClick:()=>{U(""),B(!1),z([])},children:"x"})]}),(0,b.jsx)(i.A,{onClick:$,type:"primary",style:{marginLeft:7},icon:(0,b.jsx)(_,{size:16}),shape:"round"})]}),(0,b.jsx)("ul",{className:"group-members",style:{height:"100%",maxHeight:300,overflow:"auto"},children:Y.map(e=>{var t,r;const a=null===(t=A[e.username])||void 0===t?void 0:t.photo,l=null!==(r=w[e.username])&&void 0!==r?r:v;return E.includes(e._id)?null:(0,b.jsxs)("li",{className:"group-members__item",children:[a?(0,b.jsx)(u.eu,{img:a.url,className:"group-members__item__img"}):(0,b.jsx)(m.A,{name:e.name,className:"group-members__item__img"}),(0,b.jsxs)("div",{className:"group-members__item__name",children:[(0,b.jsx)("div",{className:"member-title",children:e.name}),(0,b.jsx)(n.A,{expandIconPosition:"right",className:"collapse-wrapper",activeKey:e.username,bordered:!1,children:(0,b.jsx)(n.A.Panel,{header:(0,b.jsx)("span",{className:"text-capitalize",children:g.nc[l.role]}),showArrow:!1,disabled:0===[...l.member_groups,...l.leader_groups].length,children:(0,b.jsxs)("ul",{children:[l.leader_groups.map(e=>(0,b.jsxs)("li",{children:[(0,b.jsx)(c.N_,{to:"/working-group/".concat((0,g.E$)(e.title)),children:null===e||void 0===e?void 0:e.title})," - ",T("as a leader")]},e.id)),l.member_groups.map(e=>(0,b.jsx)("li",{children:(0,b.jsx)(c.N_,{to:"/working-group/".concat((0,g.E$)(e.title)),children:null===e||void 0===e?void 0:e.title})},e.title))]})},e.username)})]}),(0,b.jsx)(i.A,{disabled:e.username===s.id,onClick:()=>W(e._id),shape:"round",type:"primary",icon:(0,b.jsx)(j.A,{size:16}),children:T("Add")})]},e._id)})})]})})}}}]);