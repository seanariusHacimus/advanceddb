"use strict";(self.webpackChunkadvanced_db=self.webpackChunkadvanced_db||[]).push([[942],{74942:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var s=n(89379),a=n(9950),l=n(27741),r=n(6669),o=n(76580),c=n(56033),i=n(54998),d=n(22253),u=n(61456),h=(n(14535),n(32741)),m=n(44414);const g={title:{fontSize:24,fontWeight:400,lineHeight:"30px",color:"#252A32"}},p=function(e){const{setSelectedUser:t,accounts:n,rocketAuth:p,conversations:x,allAccountsById:f,setNewConversation:b}=(0,a.useContext)(i.d),[w,C]=(0,a.useState)([]),[y,j]=(0,a.useState)([]),[k,S]=(0,a.useState)([]),[v,A]=(0,a.useState)({}),[R,I]=(0,a.useState)(""),N=(0,a.useRef)(null),[q]=(0,d.Y)(),M=[{title:"Working group",dataIndex:"title",render:e=>(0,m.jsx)("a",{children:q(e)})},{title:"Members",dataIndex:"members",render:(e,t)=>"".concat([...t.members,...t.leaders].length," ").concat(q("members"))}],z={selectedRowKeys:y,onChange:(e,t)=>{let n=[];t.forEach(e=>{[...e.leaders,...e.members].map(e=>{n.push(e.id)})}),j(e),C(n)}};(0,a.useEffect)(()=>{!async function(){const e=await(0,u.De)();e.success?S(e.data):S([])}()},[]);const O=(0,a.useCallback)(async()=>{try{const e=R.trim().length?R:N.current.value,{token:t,user_id:n}=p,{data:s}=await h.f.get("/groups.list",{headers:{"X-Auth-Token":"".concat(t),"X-User-Id":n}});return 0===s.groups.filter(t=>t.name.toLowerCase()===e.toLowerCase().replace(/\s/g,"-")).length}catch(e){return!1}},[p,R]),T=(0,a.useCallback)(async()=>{await O()?(b({id:"newGroup",rid:"newGroup",fname:R,roles:["owner"],name:R,usersCount:w.length+1,members:[...new Set(w)],t:"p"}),e.handleModal()):A({"error-duplicate-channel-name":q("The group name exists. Choose another name")})},[w,R,p]),$=t=>{I(""),C([]),e.handleModal()};return console.log(k),(0,m.jsx)(o.x,{children:(0,m.jsxs)(l.A,{title:null,footer:null,zIndex:1080,onOk:t=>{I(""),C([]),e.handleModal()},destroyOnClose:!0,onCancel:$,visible:e.visible,children:[(0,m.jsx)("h2",{style:g.title,children:q("New conversation")}),(0,m.jsxs)(c.oi,{className:"has-messages",children:[(0,m.jsx)(c.pd,{required:!0,type:"text",name:"title",value:R,ref:N,id:"wg-title",autoComplete:"off",className:"dynamic-input ".concat(R?"has-value":""," ").concat(v["error-duplicate-channel-name"]||v.isRequired?"input-error":""),onChange:e=>I(e.target.value)}),(0,m.jsx)("label",{htmlFor:"",onClick:()=>N.current.focus(),children:q("Add subject *")}),(v["error-duplicate-channel-name"]||v.isRequired)&&(0,m.jsx)("span",{className:"input-msg error-msg",style:{alignSelf:"flex-start"},children:v["error-duplicate-channel-name"]||v.isRequired})]}),(0,m.jsx)(r.A,{rowSelection:(0,s.A)({type:"checkbox"},z),rowKey:"id",style:{marginBottom:15,height:"100%",maxHeight:300,overflow:"scroll"},columns:M,dataSource:k,pagination:{pageSize:k.length,hideOnSinglePage:!0}},"id"),w.length?(0,m.jsxs)("p",{children:[(0,m.jsx)("b",{children:[...new Set(w)].length})," ",q("members selected")]}):null,(0,m.jsxs)(c.so,{style:{marginTop:10},children:[(0,m.jsx)(c.$n,{type:"reset",onClick:$,style:{height:51,marginRight:12},children:q("Cancel")}),(0,m.jsx)(c.$$,{disabled:!R,onClick:T,children:q("Start messaging")})]})]})})}}}]);